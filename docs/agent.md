# åŒæ™ºèƒ½ä½“æ§è¯ŠååŒç³»ç»Ÿ

## æ‘˜è¦

æœ¬ç« è¯¦ç»†ä»‹ç»äº†èˆ¹ç”¨æŸ´æ²¹æœºæ§è¯ŠååŒç³»ç»Ÿä¸­çš„åŒæ™ºèƒ½ä½“æ¶æ„è®¾è®¡ä¸å®ç°ã€‚ç³»ç»Ÿé‡‡ç”¨**è¯Šæ–­æ™ºèƒ½ä½“**å’Œ**æ§åˆ¶æ™ºèƒ½ä½“**ååŒå·¥ä½œçš„æ¨¡å¼ï¼Œé€šè¿‡**åè°ƒæ™ºèƒ½ä½“**è¿›è¡Œç»Ÿä¸€è°ƒåº¦å’Œå†²çªè§£å†³ã€‚è¯Šæ–­æ™ºèƒ½ä½“åŸºäºKANï¼ˆKolmogorov-Arnold Networkï¼‰ä¸ºä¸»ã€PINNï¼ˆPhysics-Informed Neural Networkï¼‰ä¸ºè¾…çš„æ··åˆè¯Šæ–­ç­–ç•¥ï¼›æ§åˆ¶æ™ºèƒ½ä½“é‡‡ç”¨TD-MPC2ï¼ˆTemporal Difference Model Predictive Control 2ï¼‰å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼Œå®ç°äº†89.7%çš„Pmaxæ§åˆ¶è¾¾æ ‡ç‡ï¼Œæ˜¾è‘—ä¼˜äºä¼ ç»ŸPIDå’ŒDQNæ–¹æ³•ã€‚

---

## 1. ç³»ç»Ÿæ¶æ„æ¦‚è¿°

### 1.1 åŒæ™ºèƒ½ä½“ç³»ç»Ÿè®¾è®¡ç†å¿µ

èˆ¹ç”¨æŸ´æ²¹æœºçš„æ•…éšœè¯Šæ–­ä¸ä¸»åŠ¨å®¹é”™æ§åˆ¶æ˜¯ä¸¤ä¸ªç´§å¯†è€¦åˆçš„ä»»åŠ¡ã€‚ä¼ ç»Ÿæ–¹æ¡ˆå°†äºŒè€…ç‹¬ç«‹è®¾è®¡ï¼Œå¯¼è‡´ä»¥ä¸‹é—®é¢˜ï¼š

1. **ä¿¡æ¯å­¤å²›**ï¼šè¯Šæ–­ç»“æœæ— æ³•å®æ—¶æŒ‡å¯¼æ§åˆ¶ç­–ç•¥
2. **å“åº”æ»å**ï¼šæ§åˆ¶å™¨æ— æ³•é¢„åˆ¤æ•…éšœè¶‹åŠ¿
3. **å†³ç­–å†²çª**ï¼šè¯Šæ–­å»ºè®®ä¸æ§åˆ¶ç›®æ ‡å¯èƒ½çŸ›ç›¾

æœ¬ç³»ç»Ÿé‡‡ç”¨**å¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼ˆMulti-Agent System, MASï¼‰**æ¶æ„ï¼Œå°†è¯Šæ–­å’Œæ§åˆ¶å°è£…ä¸ºä¸¤ä¸ªåä½œæ™ºèƒ½ä½“ï¼Œé€šè¿‡æ¶ˆæ¯ä¼ é€’æœºåˆ¶å®ç°å®æ—¶ååŒã€‚

> **ğŸ“Š å›¾ç‰‡ä½ç½®ï¼š** åœ¨æ­¤å¤„æ’å…¥ `visualization_output/system_architecture.png` - åŒæ™ºèƒ½ä½“ç³»ç»Ÿæ¶æ„å›¾

### 1.2 ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        åè°ƒæ™ºèƒ½ä½“ (Coordinator)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  æ¶ˆæ¯è·¯ç”±å™¨   â”‚  â”‚  å†²çªè§£å†³å™¨   â”‚  â”‚      ç³»ç»ŸçŠ¶æ€ç®¡ç†å™¨        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚ åè°ƒä¸åˆ†å‘
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                           â”‚
         â–¼                                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     è¯Šæ–­æ™ºèƒ½ä½“           â”‚  â—„â”€â”€â”€â”€â–º  â”‚        æ§åˆ¶æ™ºèƒ½ä½“            â”‚
â”‚  (DiagnosisAgent)       â”‚   æ¶ˆæ¯    â”‚     (ControlAgent)          â”‚
â”‚                         â”‚   é€šä¿¡    â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ KAN+PINNæ··åˆè¯Šæ–­å™¨ â”‚  â”‚           â”‚  â”‚   TD-MPC2æ§åˆ¶å™¨        â”‚  â”‚
â”‚  â”‚  (60% + 40%æŠ•ç¥¨)   â”‚  â”‚           â”‚  â”‚ (ä¸–ç•Œæ¨¡å‹+CEMè§„åˆ’)     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ è‡ªé€‚åº”é˜ˆå€¼å­¦ä¹ å™¨   â”‚  â”‚           â”‚  â”‚    PIDå®‰å…¨å…œåº•å±‚       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   è¶‹åŠ¿é¢„æµ‹å™¨       â”‚  â”‚           â”‚  â”‚    å®‰å…¨çº¦æŸæ£€æŸ¥å™¨      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                                      â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   é›¶ç»´æŸ´æ²¹æœºä»¿çœŸæ¨¡å‹            â”‚
              â”‚   (MarineEngine0D)            â”‚
              â”‚                               â”‚
              â”‚  â€¢ å‡ ä½•æ¨¡å— (EngineGeometry)   â”‚
              â”‚  â€¢ ç‡ƒçƒ§æ¨¡å‹ (Wiebe)           â”‚
              â”‚  â€¢ ä¼ çƒ­æ¨¡å‹ (Woschni)         â”‚
              â”‚  â€¢ çƒ­åŠ›å­¦æ±‚è§£å™¨               â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 æ™ºèƒ½ä½“é€šä¿¡åè®®

ç³»ç»Ÿå®šä¹‰äº†å®Œæ•´çš„æ¶ˆæ¯ç±»å‹æšä¸¾ï¼Œæ”¯æŒè¯Šæ–­ã€æ§åˆ¶ã€åè°ƒä¸‰ç±»æ¶ˆæ¯ï¼š

```python
class MessageType(Enum):
    """æ™ºèƒ½ä½“æ¶ˆæ¯ç±»å‹"""
    # è¯Šæ–­ç›¸å…³
    DIAGNOSIS_REQUEST = auto()      # è¯·æ±‚è¯Šæ–­
    DIAGNOSIS_RESULT = auto()       # è¯Šæ–­ç»“æœ
    FAULT_ALERT = auto()            # æ•…éšœè­¦æŠ¥

    # æ§åˆ¶ç›¸å…³
    CONTROL_REQUEST = auto()        # è¯·æ±‚æ§åˆ¶åŠ¨ä½œ
    CONTROL_ACTION = auto()         # æ§åˆ¶åŠ¨ä½œè¾“å‡º
    CONTROL_FEEDBACK = auto()       # æ§åˆ¶æ•ˆæœåé¦ˆ

    # åè°ƒç›¸å…³
    STATE_UPDATE = auto()           # çŠ¶æ€æ›´æ–°
    MODE_CHANGE = auto()            # æ¨¡å¼åˆ‡æ¢
    CONFLICT_RESOLUTION = auto()    # å†²çªè§£å†³

    # å­¦ä¹ ç›¸å…³
    EXPERIENCE = auto()             # ç»éªŒæ•°æ® (ç”¨äºåœ¨çº¿å­¦ä¹ )
    MODEL_UPDATE = auto()           # æ¨¡å‹æ›´æ–°é€šçŸ¥
```

---

## 2. æ™ºèƒ½ä½“åŸºç±»ä¸æ„ŸçŸ¥-å†³ç­–-æ‰§è¡Œå¾ªç¯

### 2.1 æ™ºèƒ½ä½“æŠ½è±¡åŸºç±»

æ‰€æœ‰æ™ºèƒ½ä½“ç»§æ‰¿è‡ªç»Ÿä¸€çš„æŠ½è±¡åŸºç±» `Agent`ï¼Œéµå¾ªç»å…¸çš„**æ„ŸçŸ¥-å†³ç­–-æ‰§è¡Œ-å­¦ä¹ ï¼ˆPerceive-Decide-Act-Learnï¼‰**å¾ªç¯ï¼š

```python
class Agent(ABC):
    """
    æ™ºèƒ½ä½“æŠ½è±¡åŸºç±»
    éµå¾ª Perceive -> Decide -> Act -> Learn å¾ªç¯
    """

    def __init__(self, name: str, engine=None):
        self.name = name
        self.engine = engine
        self.state = AgentState(name=name)

        # æ¶ˆæ¯é˜Ÿåˆ—
        self.inbox: List[AgentMessage] = []
        self.outbox: List[AgentMessage] = []

        # ç»éªŒç¼“å†²åŒº (ç”¨äºå­¦ä¹ )
        self.experience_buffer: List[Dict] = []
        self.buffer_size = 10000

        # å­¦ä¹ å‚æ•°
        self.learning_enabled = True
        self.learning_rate = 0.001

    @abstractmethod
    def perceive(self, observation: Dict[str, Any]) -> Dict[str, Any]:
        """æ„ŸçŸ¥ç¯å¢ƒï¼Œå¤„ç†åŸå§‹è§‚æµ‹æ•°æ®"""
        pass

    @abstractmethod
    def decide(self, perception: Dict[str, Any]) -> Any:
        """åŸºäºæ„ŸçŸ¥ç»“æœè¿›è¡Œå†³ç­–"""
        pass

    @abstractmethod
    def act(self, decision: Any) -> Dict[str, Any]:
        """æ‰§è¡Œå†³ç­–åŠ¨ä½œ"""
        pass

    def learn(self, experience: Dict[str, Any]) -> None:
        """ä»ç»éªŒä¸­åœ¨çº¿å­¦ä¹ """
        pass
```

### 2.2 æ™ºèƒ½ä½“ç”Ÿå‘½å‘¨æœŸ

æ¯ä¸ªæ—¶é—´æ­¥ï¼Œæ™ºèƒ½ä½“æ‰§è¡Œä»¥ä¸‹æµç¨‹ï¼š

$$
\text{Observation} \xrightarrow{\text{perceive}} \text{Perception} \xrightarrow{\text{decide}} \text{Decision} \xrightarrow{\text{act}} \text{Action}
$$

> **ğŸ“Š å›¾ç‰‡ä½ç½®ï¼š** åœ¨æ­¤å¤„æ’å…¥ `visualization_output/agent_lifecycle.png` - æ™ºèƒ½ä½“ç”Ÿå‘½å‘¨æœŸå›¾

---

## 3. æ•°æ®è·å–ä¸ä»¿çœŸæ¨¡å‹æ¥å£

### 3.1 é›¶ç»´æŸ´æ²¹æœºä»¿çœŸæ¨¡å‹

æ™ºèƒ½ä½“é€šè¿‡ `MarineEngine0D` ç±»è·å–å‘åŠ¨æœºçŠ¶æ€æ•°æ®ã€‚è¯¥æ¨¡å‹é›†æˆäº†ï¼š

- **å‡ ä½•æ¨¡å—**ï¼šæ°”ç¼¸å‡ ä½•å‚æ•°ï¼ˆç¼¸å¾„ã€è¡Œç¨‹ã€å‹ç¼©æ¯”ï¼‰
- **ç‡ƒçƒ§æ¨¡å‹**ï¼šåŒéŸ¦ä¼¯å‡½æ•°ç‡ƒçƒ§æ¨¡å‹
- **ä¼ çƒ­æ¨¡å‹**ï¼šWoschniä¼ çƒ­ç›¸å…³å¼
- **çƒ­åŠ›å­¦æ±‚è§£å™¨**ï¼šå¾ªç¯ä»¿çœŸæ±‚è§£å™¨

### 3.2 è§‚æµ‹æ•°æ®ç»“æ„

æ¯ä¸ªä»¿çœŸæ­¥è¿”å›çš„è§‚æµ‹æ•°æ®åŒ…å«ï¼š

| å‚æ•°å       | ç¬¦å·           | å•ä½ | è¯´æ˜           |
| ------------ | -------------- | ---- | -------------- |
| æœ€é«˜çˆ†å‘å‹åŠ› | $P_{max}$      | bar  | ç‡ƒçƒ§å³°å€¼å‹åŠ›   |
| å‹ç¼©ç»ˆç‚¹å‹åŠ› | $P_{comp}$     | bar  | å‹ç¼©ä¸Šæ­¢ç‚¹å‹åŠ› |
| æ’æ°”æ¸©åº¦     | $T_{exh}$      | Â°C   | ç¼¸å†…æ’æ°”æ¸©åº¦   |
| è½¬é€Ÿ         | $n$            | rpm  | å‘åŠ¨æœºè½¬é€Ÿ     |
| è´Ÿè·         | $L$            | %    | ç›¸å¯¹è´Ÿè·       |
| å–·æ²¹æ­£æ—¶     | $\theta_{inj}$ | Â°CA  | å–·æ²¹æå‰è§’     |

### 3.3 æ•°æ®è·å–æ¥å£

```python
# ä»ä»¿çœŸæ¨¡å‹è·å–æ•°æ®
state = engine.simulate_cycle(rpm=100, load=0.75)

# è¿”å›çš„è§‚æµ‹æ•°æ®
observation = {
    'Pmax': state['Pmax'],      # æœ€é«˜çˆ†å‘å‹åŠ› [bar]
    'Pcomp': state['Pcomp'],    # å‹ç¼©å‹åŠ› [bar]
    'Texh': state['Texh'],      # æ’æ°”æ¸©åº¦ [Â°C]
    'rpm': condition.rpm,       # è½¬é€Ÿ [rpm]
    'load': condition.load,     # è´Ÿè· [%]
    'timing': condition.timing, # å–·æ²¹æ­£æ—¶ [Â°CA]
}
```

### 3.4 æ®‹å·®è®¡ç®—

è¯Šæ–­æ™ºèƒ½ä½“è®¡ç®—è§‚æµ‹å€¼ä¸æ¨¡å‹é¢„æµ‹å€¼ä¹‹é—´çš„**ç›¸å¯¹æ®‹å·®**ï¼š

$$
r_i = \frac{Y_i^{meas} - Y_i^{model}}{Y_i^{model}}
$$

å…¶ä¸­ï¼š

- $Y_i^{meas}$ ä¸ºæµ‹é‡å€¼
- $Y_i^{model}$ ä¸ºæ¨¡å‹é¢„æµ‹å€¼
- $i \in \{P_{max}, P_{comp}, T_{exh}\}$

> **ğŸ“Š å›¾ç‰‡ä½ç½®ï¼š** åœ¨æ­¤å¤„æ’å…¥ `visualization_output/simulation_results.png` - ä»¿çœŸç»“æœä¸æ®‹å·®å›¾

---

## 4. è¯Šæ–­æ™ºèƒ½ä½“è¯¦ç»†è®¾è®¡

### 4.1 æ··åˆè¯Šæ–­æ¶æ„

è¯Šæ–­æ™ºèƒ½ä½“é‡‡ç”¨ **KANä¸ºä¸»ã€PINNä¸ºè¾…** çš„æ··åˆè¯Šæ–­ç­–ç•¥ï¼Œé€šè¿‡æŠ•ç¥¨æœºåˆ¶èåˆä¸¤ç§æ–¹æ³•çš„è¯Šæ–­ç»“æœã€‚

```
                    è¾“å…¥ç‰¹å¾ (8ç»´)
                         â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                           â”‚
           â–¼                           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    KAN      â”‚            â”‚    PINN     â”‚
    â”‚  è¯Šæ–­å™¨      â”‚            â”‚   è¯Šæ–­å™¨     â”‚
    â”‚  (60%)      â”‚            â”‚   (40%)     â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚                           â”‚
           â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
           â””â”€â”€â–ºâ”‚   æŠ•ç¥¨èåˆæœºåˆ¶    â”‚â—„â”€â”€â”€â”˜
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚  æœ€ç»ˆè¯Šæ–­ç»“æœ   â”‚
               â”‚  + ç¬¦å·è§„åˆ™     â”‚
               â”‚  + ç‰©ç†æ®‹å·®     â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 KANè¯Šæ–­å™¨åŸç†

#### 4.2.1 Kolmogorov-Arnoldè¡¨ç¤ºå®šç†

KANç½‘ç»œåŸºäºKolmogorov-Arnoldè¡¨ç¤ºå®šç†ï¼Œè¯¥å®šç†æŒ‡å‡ºä»»ä½•å¤šå…ƒè¿ç»­å‡½æ•°éƒ½å¯ä»¥è¡¨ç¤ºä¸ºï¼š

$$
f(x_1, x_2, \ldots, x_n) = \sum_{q=0}^{2n} \Phi_q \left( \sum_{p=1}^{n} \phi_{q,p}(x_p) \right)
$$

å…¶ä¸­ï¼š

- $\phi_{q,p}: [0,1] \rightarrow \mathbb{R}$ æ˜¯å•å˜é‡å†…éƒ¨å‡½æ•°
- $\Phi_q: \mathbb{R} \rightarrow \mathbb{R}$ æ˜¯å¤–éƒ¨å‡½æ•°

#### 4.2.2 KANä¸MLPå¯¹æ¯”

| ç‰¹æ€§     | MLP                  | KAN                          |
| -------- | -------------------- | ---------------------------- |
| æ¿€æ´»å‡½æ•° | å›ºå®šï¼ˆReLU, Tanhç­‰ï¼‰ | **å¯å­¦ä¹ ï¼ˆBæ ·æ¡ï¼‰**          |
| æƒé‡ä½ç½® | è¾¹ä¸Šï¼ˆè¿æ¥æƒé‡ï¼‰     | èŠ‚ç‚¹ä¸Šï¼ˆæ¿€æ´»å‚æ•°ï¼‰           |
| å‚æ•°æ•ˆç‡ | $O(n^2)$             | $O(n \cdot k)$ï¼Œå°‘100-1000å€ |
| å¯è§£é‡Šæ€§ | é»‘ç®±                 | **å¯æå–ç¬¦å·è§„åˆ™**           |
| ç‰©ç†å‘ç° | å›°éš¾                 | è‡ªåŠ¨å‘ç°ç‰©ç†å…³ç³»             |

#### 4.2.3 Bæ ·æ¡åŸºå‡½æ•°

KANä½¿ç”¨Bæ ·æ¡å‚æ•°åŒ–å¯å­¦ä¹ æ¿€æ´»å‡½æ•°ï¼š

$$
\phi(x) = w_{base} \cdot \text{silu}(x) + w_{scale} \cdot \text{spline}(x)
$$

å…¶ä¸­Bæ ·æ¡å®šä¹‰ä¸ºï¼š

$$
\text{spline}(x) = \sum_{i=0}^{G+k} c_i \cdot B_{i,k}(x)
$$

- $G$: ç½‘æ ¼å¤§å°
- $k$: æ ·æ¡é˜¶æ•°
- $c_i$: å¯å­¦ä¹ æ§åˆ¶ç‚¹
- $B_{i,k}(x)$: ç¬¬$i$ä¸ª$k$é˜¶Bæ ·æ¡åŸºå‡½æ•°

#### 4.2.4 ç¬¦å·è§„åˆ™æå–

KANçš„å…³é”®ä¼˜åŠ¿åœ¨äºå¯ä»¥è‡ªåŠ¨æå–å¯è§£é‡Šçš„è¯Šæ–­è§„åˆ™ï¼š

```python
# æå–çš„ç¬¦å·è§„åˆ™ç¤ºä¾‹
rules = [
    "IF Pmax_residual > 0.03 AND timing > 0 THEN fault = TIMING_EARLY",
    "IF Pcomp_residual < -0.02 AND Texh_residual > 0.05 THEN fault = CYLINDER_LEAK",
    "IF Pmax_residual < -0.02 AND Texh_residual < -0.03 THEN fault = FUEL_DEGRADATION"
]
```

### 4.3 PINNè¯Šæ–­å™¨åŸç†

#### 4.3.1 ç‰©ç†çº¦æŸåµŒå…¥

PINNå°†æŸ´æ²¹æœºçƒ­åŠ›å­¦æ–¹ç¨‹ä½œä¸ºè½¯çº¦æŸåµŒå…¥ç¥ç»ç½‘ç»œè®­ç»ƒï¼š

**1. å‹ç¼©å¤šå˜æ–¹ç¨‹**ï¼š

$$
\frac{P_{comp}}{P_1} = \left( \frac{V_1}{V_{comp}} \right)^n = r_c^n
$$

å…¶ä¸­ $r_c$ ä¸ºå‹ç¼©æ¯”ï¼Œ$n$ ä¸ºå¤šå˜æŒ‡æ•°ï¼ˆå…¸å‹å€¼1.35ï¼‰ã€‚

**2. ç»´è´ç‡ƒçƒ§æ¨¡å‹**ï¼š

$$
\frac{dQ_b}{d\theta} = \frac{a \cdot m \cdot Q_{total}}{\Delta\theta} \left( \frac{\theta - \theta_0}{\Delta\theta} \right)^{m-1} \exp \left[ -a \left( \frac{\theta - \theta_0}{\Delta\theta} \right)^m \right]
$$

**3. èƒ½é‡å®ˆæ’æ–¹ç¨‹**ï¼š

$$
Q_{fuel} = W_{indicated} + Q_{cooling} + Q_{exhaust} + Q_{loss}
$$

#### 4.3.2 PINNæŸå¤±å‡½æ•°

æ€»æŸå¤±å‡½æ•°ç”±æ•°æ®æŸå¤±å’Œç‰©ç†æŸå¤±ç»„æˆï¼š

$$
\mathcal{L}_{total} = \underbrace{\mathcal{L}_{data}}_{\text{æ•°æ®æ‹Ÿåˆ}} + \lambda_{phys} \cdot \underbrace{\mathcal{L}_{physics}}_{\text{ç‰©ç†çº¦æŸ}}
$$

**æ•°æ®æŸå¤±**ï¼ˆåˆ†ç±»äº¤å‰ç†µï¼‰ï¼š

$$
\mathcal{L}_{data} = -\sum_{i=1}^{N} \sum_{c=1}^{C} y_{i,c} \log(\hat{y}_{i,c})
$$

**ç‰©ç†æŸå¤±**ï¼ˆç‰©ç†æ®‹å·®MSEï¼‰ï¼š

$$
\mathcal{L}_{physics} = \frac{1}{N} \sum_{i=1}^{N} \left[ (P_{max}^{pred} - P_{max}^{phys})^2 + (P_{comp}^{pred} - P_{comp}^{phys})^2 + (T_{exh}^{pred} - T_{exh}^{phys})^2 \right]
$$

### 4.4 æŠ•ç¥¨èåˆæœºåˆ¶

å½“KANå’ŒPINNè¯Šæ–­ç»“æœä¸ä¸€è‡´æ—¶ï¼Œé‡‡ç”¨åŠ æƒæŠ•ç¥¨ï¼š

$$
\text{score}(c) = w_{KAN} \cdot p_{KAN}(c) + w_{PINN} \cdot p_{PINN}(c)
$$

å…¶ä¸­ï¼š

- $w_{KAN} = 0.6$ï¼ˆKANæƒé‡ï¼‰
- $w_{PINN} = 0.4$ï¼ˆPINNæƒé‡ï¼‰
- $p_{KAN}(c), p_{PINN}(c)$ ä¸ºå„è¯Šæ–­å™¨å¯¹æ•…éšœç±»å‹$c$çš„ç½®ä¿¡åº¦

æœ€ç»ˆè¯Šæ–­ç»“æœï¼š

$$
\hat{c} = \arg\max_c \text{score}(c)
$$

> **ğŸ“Š å›¾ç‰‡ä½ç½®ï¼š** åœ¨æ­¤å¤„æ’å…¥ `visualization_output/diagnosis_agent_analysis.png` - è¯Šæ–­æ™ºèƒ½ä½“åˆ†æå›¾

---

## 5. æ§åˆ¶æ™ºèƒ½ä½“è¯¦ç»†è®¾è®¡

### 5.1 åˆ†å±‚æ§åˆ¶æ¶æ„

æ§åˆ¶æ™ºèƒ½ä½“é‡‡ç”¨åˆ†å±‚æ¶æ„ï¼Œç¡®ä¿å®‰å…¨æ€§å’Œæ€§èƒ½ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é«˜å±‚: TD-MPC2å¼ºåŒ–å­¦ä¹ ç­–ç•¥                        â”‚
â”‚  (ä¸–ç•Œæ¨¡å‹ + CEMè§„åˆ’)                            â”‚
â”‚  è¾“å‡º: VITè°ƒæ•´é‡ + ç‡ƒæ²¹å€ç‡                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸­å±‚: æ§åˆ¶æ¨¡å¼é€‰æ‹©å™¨                             â”‚
â”‚  NORMAL / FAULT_TOLERANT / DEGRADED / EMERGENCY â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åº•å±‚: PIDå®‰å…¨å…œåº•æ§åˆ¶å™¨                          â”‚
â”‚  (å½“RLæœªæ”¶æ•›æˆ–ç´§æ€¥æƒ…å†µæ—¶æ¥ç®¡)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®‰å…¨å±‚: ç¡¬çº¦æŸæ£€æŸ¥                               â”‚
â”‚  Pmax < 190bar, VIT âˆˆ [-8Â°, +4Â°]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 TD-MPC2ç®—æ³•åŸç†

#### 5.2.1 ç®—æ³•æ¦‚è¿°

TD-MPC2ï¼ˆTemporal Difference Model Predictive Control 2ï¼‰æ˜¯Hansenç­‰äººäºICLR 2024æå‡ºçš„æœ€æ–°å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼Œç»“åˆäº†ï¼š

1. **æ—¶åºå·®åˆ†å­¦ä¹ ï¼ˆTD Learningï¼‰**ï¼šé«˜æ•ˆçš„å€¼å‡½æ•°ä¼°è®¡
2. **æ¨¡å‹é¢„æµ‹æ§åˆ¶ï¼ˆMPCï¼‰**ï¼šåŸºäºå­¦ä¹ çš„ä¸–ç•Œæ¨¡å‹è¿›è¡Œåœ¨çº¿è§„åˆ’
3. **äº¤å‰ç†µæ–¹æ³•ï¼ˆCEMï¼‰**ï¼šåŠ¨ä½œåºåˆ—ä¼˜åŒ–

#### 5.2.2 ä¸–ç•Œæ¨¡å‹ç»“æ„

TD-MPC2çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„ä¸–ç•Œæ¨¡å‹ï¼ŒåŒ…å«ï¼š

**1. çŠ¶æ€ç¼–ç å™¨** $h = f_\theta(s)$ï¼š

$$
h = \text{MLP}(s) \in \mathbb{R}^{256}
$$

å°†10ç»´çŠ¶æ€å‘é‡ç¼–ç ä¸º256ç»´æ½œåœ¨è¡¨ç¤ºã€‚

**2. è½¬ç§»é¢„æµ‹å™¨** $\hat{h}' = g_\theta(h, a)$ï¼š

$$
\hat{h}' = \text{MLP}([h; a])
$$

é¢„æµ‹ä¸‹ä¸€æ—¶åˆ»çš„æ½œåœ¨çŠ¶æ€ã€‚

**3. å¥–åŠ±é¢„æµ‹å™¨** $\hat{r} = r_\theta(h)$ï¼š

$$
\hat{r} = \text{MLP}(h) \in \mathbb{R}
$$

**4. Qå€¼ç½‘ç»œ** $Q_\theta(h, a)$ï¼š

$$
Q = \text{MLP}([h; a]) \in \mathbb{R}^{|A|}
$$

#### 5.2.3 CEMåœ¨çº¿è§„åˆ’

åœ¨æ¯ä¸ªå†³ç­–æ­¥ï¼Œä½¿ç”¨äº¤å‰ç†µæ–¹æ³•ä¼˜åŒ–åŠ¨ä½œåºåˆ—ï¼š

**ç®—æ³•æµç¨‹**ï¼š

1. **åˆå§‹åŒ–**ï¼šåŠ¨ä½œåˆ†å¸ƒ $\mu^{(0)} = 0$, $\sigma^{(0)} = 2$

2. **é‡‡æ ·**ï¼šç”Ÿæˆ $N$ ä¸ªåŠ¨ä½œåºåˆ—

   $$
   \{a_{0:H}^{(i)}\}_{i=1}^{N} \sim \mathcal{N}(\mu, \sigma)
   $$

3. **è¯„ä¼°**ï¼šè®¡ç®—æ¯ä¸ªåºåˆ—çš„ç´¯è®¡å›æŠ¥

   $$
   R^{(i)} = \sum_{t=0}^{H-1} \gamma^t \hat{r}(h_t^{(i)}) + \gamma^H V(h_H^{(i)})
   $$

4. **ç²¾è‹±é€‰æ‹©**ï¼šä¿ç•™Top-Kåºåˆ—

   $$
   \text{elite} = \text{argsort}(R)[-K:]
   $$

5. **åˆ†å¸ƒæ›´æ–°**ï¼š

   $$
   \mu^{(k+1)} = \text{mean}(\{a^{(i)}\}_{i \in \text{elite}})
   $$

   $$
   \sigma^{(k+1)} = \text{std}(\{a^{(i)}\}_{i \in \text{elite}}) + 0.1
   $$

6. **é‡å¤**æ­¥éª¤2-5å…± $I$ æ¬¡è¿­ä»£

7. **è¿”å›**ï¼šç¬¬ä¸€æ­¥æœ€ä¼˜åŠ¨ä½œ $a_0^* = \text{argmax}(\mu_0)$

#### 5.2.4 è®­ç»ƒæŸå¤±å‡½æ•°

ä¸–ç•Œæ¨¡å‹é€šè¿‡ä»¥ä¸‹æŸå¤±å‡½æ•°è”åˆè®­ç»ƒï¼š

$$
\mathcal{L} = \underbrace{\mathcal{L}_{dynamics}}_{\text{è½¬ç§»é¢„æµ‹}} + \underbrace{\mathcal{L}_{reward}}_{\text{å¥–åŠ±é¢„æµ‹}} + \underbrace{\mathcal{L}_{TD}}_{\text{æ—¶åºå·®åˆ†}}
$$

**åŠ¨åŠ›å­¦æŸå¤±**ï¼š

$$
\mathcal{L}_{dynamics} = \mathbb{E}_{(s,a,s') \sim \mathcal{B}} \left[ \| g_\theta(f_\theta(s), a) - f_\theta(s') \|_2^2 \right]
$$

**å¥–åŠ±é¢„æµ‹æŸå¤±**ï¼š

$$
\mathcal{L}_{reward} = \mathbb{E}_{(s,a,r) \sim \mathcal{B}} \left[ (r_\theta(f_\theta(s)) - r)^2 \right]
$$

**TDæŸå¤±**ï¼š

$$
\mathcal{L}_{TD} = \mathbb{E}_{(s,a,r,s') \sim \mathcal{B}} \left[ (Q_\theta(s,a) - (r + \gamma \max_{a'} Q_{\bar\theta}(s', a')))^2 \right]
$$

### 5.3 çŠ¶æ€ç¼–ç 

æ§åˆ¶æ™ºèƒ½ä½“å°†è§‚æµ‹æ•°æ®ç¼–ç ä¸º10ç»´å½’ä¸€åŒ–çŠ¶æ€å‘é‡ï¼š

```python
state = [
    Pmax / 200.0,           # å½’ä¸€åŒ–çˆ†å‘å‹åŠ›
    Pcomp / 200.0,          # å½’ä¸€åŒ–å‹ç¼©å‹åŠ›
    Texh / 500.0,           # å½’ä¸€åŒ–æ’æ°”æ¸©åº¦
    r_Pmax,                 # Pmaxæ®‹å·®
    r_Pcomp,                # Pcompæ®‹å·®
    r_Texh,                 # Texhæ®‹å·®
    fault_type_enc,         # æ•…éšœç±»å‹ç¼–ç 
    mode_enc,               # è¯Šæ–­çŠ¶æ€ç¼–ç 
    (vit + 8) / 12.0,       # å½’ä¸€åŒ–VIT [-8, 4] -> [0, 1]
    (fuel - 0.7) / 0.3,     # å½’ä¸€åŒ–ç‡ƒæ²¹ [0.7, 1.0] -> [0, 1]
]
```

### 5.4 åŠ¨ä½œç©ºé—´

é‡‡ç”¨ç¦»æ•£åŒ–çš„ç»„åˆåŠ¨ä½œç©ºé—´ï¼š

- **VITè°ƒæ•´**ï¼š9æ¡£ç¦»æ•£å€¼ $\{-8, -6, -4, -2, 0, 2, 4, 6, 8\}$ Â°CA
- **ç‡ƒæ²¹å€ç‡**ï¼š5æ¡£ç¦»æ•£å€¼ $\{0.7, 0.8, 0.9, 0.95, 1.0\}$

æ€»åŠ¨ä½œæ•°ï¼š$|A| = 9 \times 5 = 45$

### 5.5 å¥–åŠ±å‡½æ•°è®¾è®¡

å¥–åŠ±å‡½æ•°åŒ…å«å®‰å…¨ã€æ•ˆç‡å’Œç¨³å®šæ€§ä¸‰ä¸ªç»´åº¦ï¼š

$$
r = r_{safety} - r_{efficiency} - r_{stability}
$$

**å®‰å…¨å¥–åŠ±**ï¼ˆæœ€é‡è¦ï¼‰ï¼š

$$
r_{safety} = \begin{cases}
1 - \frac{|P_{max} - P_{target}|}{P_{target}} & \text{if } P_{max} \leq P_{limit} \\
-5 \cdot \frac{P_{max} - P_{limit}}{P_{limit}} & \text{otherwise}
\end{cases}
$$

å…¶ä¸­ $P_{target} = 170$ barï¼Œ$P_{limit} = 190$ barã€‚

**æ•ˆç‡æƒ©ç½š**ï¼š

$$
r_{efficiency} = 0.5 \cdot (1 - \text{fuel}) + 0.02 \cdot |\text{VIT}|
$$

**ç¨³å®šæ€§æƒ©ç½š**ï¼š

$$
r_{stability} = \alpha \cdot \|\Delta u\|_2
$$

> **ğŸ“Š å›¾ç‰‡ä½ç½®ï¼š** åœ¨æ­¤å¤„æ’å…¥ `visualization_output/training_process.png` - TD-MPC2è®­ç»ƒè¿‡ç¨‹å›¾

> **ğŸ“Š å›¾ç‰‡ä½ç½®ï¼š** åœ¨æ­¤å¤„æ’å…¥ `visualization_output/control_agent_analysis.png` - æ§åˆ¶æ™ºèƒ½ä½“åˆ†æå›¾

---

## 6. åè°ƒæ™ºèƒ½ä½“ä¸å†²çªè§£å†³

### 6.1 åè°ƒæ™ºèƒ½ä½“èŒè´£

åè°ƒæ™ºèƒ½ä½“ï¼ˆ`CoordinatorAgent`ï¼‰è´Ÿè´£ï¼š

1. **æ¶ˆæ¯è·¯ç”±**ï¼šåˆ†å‘è¯Šæ–­ç»“æœå’Œæ§åˆ¶å‘½ä»¤
2. **å†²çªæ£€æµ‹**ï¼šè¯†åˆ«è¯Šæ–­ä¸æ§åˆ¶å»ºè®®çš„çŸ›ç›¾
3. **å†²çªè§£å†³**ï¼šåŸºäºå®‰å…¨ä¼˜å…ˆç­–ç•¥åè°ƒå†³ç­–
4. **ç³»ç»Ÿç›‘æ§**ï¼šè·Ÿè¸ªæ•´ä½“æ€§èƒ½æŒ‡æ ‡

### 6.2 å†²çªç±»å‹

ç³»ç»Ÿå®šä¹‰äº†å››ç§å†²çªç±»å‹ï¼š

```python
class ConflictType(Enum):
    NONE = auto()                        # æ— å†²çª
    DIAGNOSIS_CONTROL_MISMATCH = auto()  # è¯Šæ–­ä¸æ§åˆ¶ä¸åŒ¹é…
    SAFETY_PERFORMANCE_TRADEOFF = auto() # å®‰å…¨ä¸æ€§èƒ½æƒè¡¡
    RESOURCE_CONTENTION = auto()         # èµ„æºç«äº‰
    TIMING_CONFLICT = auto()             # æ—¶åºå†²çª
```

### 6.3 å†²çªæ£€æµ‹è§„åˆ™

| å†²çªåœºæ™¯ | è¯Šæ–­çŠ¶æ€   | æ§åˆ¶çŠ¶æ€    | å¤„ç†ç­–ç•¥            |
| -------- | ---------- | ----------- | ------------------- |
| åœºæ™¯1    | CRITICAL   | NORMAL      | å‡çº§ä¸ºEMERGENCYæ¨¡å¼ |
| åœºæ™¯2    | HEALTHY    | é™åŠŸè¿è¡Œ    | é€æ­¥æ¢å¤æ€§èƒ½        |
| åœºæ™¯3    | TIMINGæ•…éšœ | VITæ–¹å‘é”™è¯¯ | ä¿®æ­£VITæ–¹å‘         |

### 6.4 å†²çªè§£å†³ç®—æ³•

```python
def resolve_conflict(self, conflict_type, diagnosis, control_action, observation):
    """
    å†²çªè§£å†³ç­–ç•¥ï¼šå®‰å…¨ä¼˜å…ˆ
    """
    if conflict_type == ConflictType.DIAGNOSIS_CONTROL_MISMATCH:
        if diagnosis.diagnosis_state == DiagnosisState.CRITICAL:
            # å®‰å…¨ä¼˜å…ˆï¼šå‡çº§ä¸ºç´§æ€¥æ¨¡å¼
            return ControlAction(
                mode=ControlMode.EMERGENCY,
                vit_adjustment=-8.0,  # æœ€å¤§æ»å
                power_limit=0.8,      # é™åŠŸ80%
            )
        else:
            # è°ƒæ•´VITæ–¹å‘åŒ¹é…æ•…éšœç±»å‹
            r_Pmax = diagnosis.residuals.get('Pmax', 0)
            new_vit = -abs(vit) if r_Pmax > 0 else abs(vit)
            return ControlAction(vit_adjustment=new_vit)

    elif conflict_type == ConflictType.SAFETY_PERFORMANCE_TRADEOFF:
        # é€æ­¥æ¢å¤æ€§èƒ½
        if observation['Pmax'] < 175:  # å®‰å…¨ä½™é‡å……è¶³
            return ControlAction(power_limit=min(power_limit + 0.05, 1.0))
```

> **ğŸ“Š å›¾ç‰‡ä½ç½®ï¼š** åœ¨æ­¤å¤„æ’å…¥ `visualization_output/performance_comparison.png` - æ€§èƒ½å¯¹æ¯”åˆ†æå›¾

---

## 7. å¼ºåŒ–å­¦ä¹ è®­ç»ƒæµç¨‹

### 7.1 è®­ç»ƒç¯å¢ƒè®¾ç½®

#### 7.1.1 GPUåŠ é€Ÿé…ç½®

```python
# è‡ªåŠ¨æ£€æµ‹å¹¶é…ç½®GPU
def get_device(prefer_gpu: bool = True) -> torch.device:
    if prefer_gpu and torch.cuda.is_available():
        device = torch.device('cuda')
        print(f"ä½¿ç”¨GPU: {torch.cuda.get_device_name(0)}")
        print(f"GPUæ˜¾å­˜: {torch.cuda.get_device_properties(0).total_memory / 1024**3:.1f} GB")
        return device
    return torch.device('cpu')

# æ ¹æ®GPUæ˜¾å­˜è‡ªåŠ¨è°ƒæ•´æ‰¹æ¬¡å¤§å°
def auto_batch_size(device, base_batch=256):
    if device.type == 'cuda':
        gpu_mem = torch.cuda.get_device_properties(0).total_memory / 1024**3
        if gpu_mem >= 8:
            return 512
        elif gpu_mem >= 4:
            return 256
        else:
            return 128
    return base_batch
```

#### 7.1.2 è®­ç»ƒè¶…å‚æ•°

| å‚æ•°              | å€¼                 | è¯´æ˜          |
| ----------------- | ------------------ | ------------- |
| å­¦ä¹ ç‡            | $3 \times 10^{-4}$ | Adamä¼˜åŒ–å™¨    |
| æŠ˜æ‰£å› å­ $\gamma$ | 0.99               | é•¿æœŸå¥–åŠ±æŠ˜æ‰£  |
| è½¯æ›´æ–°ç³»æ•° $\tau$ | 0.005              | ç›®æ ‡ç½‘ç»œæ›´æ–°  |
| è§„åˆ’æ—¶åŸŸ $H$      | 2                  | CEMè§„åˆ’æ­¥æ•°   |
| é‡‡æ ·æ•° $N$        | 16                 | CEMé‡‡æ ·æ•°     |
| ç²¾è‹±æ•° $K$        | 4                  | CEMç²¾è‹±æ ·æœ¬æ•° |
| è¿­ä»£æ¬¡æ•° $I$      | 1                  | CEMè¿­ä»£æ¬¡æ•°   |
| æ¢ç´¢ç‡ $\epsilon$ | $1.0 \to 0.05$     | Îµ-greedyè¡°å‡  |
| ç»éªŒæ± å¤§å°        | 100,000            | å›æ”¾ç¼“å†²åŒº    |

### 7.2 è®­ç»ƒå¾ªç¯

```python
for episode in range(n_episodes):
    state = env.reset()
    episode_reward = 0

    for step in range(max_steps):
        # 1. æ„ŸçŸ¥ï¼šç¼–ç çŠ¶æ€
        encoded_state = agent.encode_state(observation, diagnosis, vit, fuel)

        # 2. å†³ç­–ï¼šTD-MPC2é€‰æ‹©åŠ¨ä½œ
        action_idx = agent.tdmpc2_ctrl.select_action(encoded_state, training=True)
        vit, fuel = agent.tdmpc2_ctrl.decode_action(action_idx)

        # 3. æ‰§è¡Œï¼šä¸ç¯å¢ƒäº¤äº’
        next_observation, reward, done = env.step(action_idx)

        # 4. å­˜å‚¨ç»éªŒ
        agent.replay_buffer.push(state, action_idx, reward, next_state, done)

        # 5. å­¦ä¹ ï¼šæ›´æ–°ä¸–ç•Œæ¨¡å‹
        if len(agent.replay_buffer) >= batch_size:
            batch = agent.replay_buffer.sample(batch_size)
            losses = agent.tdmpc2_ctrl.update(batch)

        episode_reward += reward
        state = next_state

        if done:
            break

    # è®°å½•è®­ç»ƒæŒ‡æ ‡
    logger.log({
        'episode': episode,
        'reward': episode_reward,
        'epsilon': agent.epsilon,
        'loss': losses.get('loss', 0)
    })
```

### 7.3 ç»éªŒå›æ”¾æœºåˆ¶

é‡‡ç”¨å‡åŒ€é‡‡æ ·çš„ç»éªŒå›æ”¾ç¼“å†²åŒºï¼š

$$
\mathcal{B} = \{(s_t, a_t, r_t, s_{t+1}, d_t)\}_{t=1}^{N}
$$

```python
class ReplayBuffer:
    def __init__(self, capacity=100000):
        self.buffer = deque(maxlen=capacity)

    def push(self, state, action, reward, next_state, done):
        self.buffer.append(Experience(state, action, reward, next_state, done))

    def sample(self, batch_size):
        return random.sample(self.buffer, batch_size)
```

> **ğŸ“Š å›¾ç‰‡ä½ç½®ï¼š** åœ¨æ­¤å¤„æ’å…¥ `results/comparison/learning_curves.png` - å­¦ä¹ æ›²çº¿å¯¹æ¯”å›¾

---

## 8. äº”ç§æ–¹æ³•å¯¹æ¯”å®éªŒ

### 8.1 å¯¹æ¯”æ–¹æ³•

ç³»ç»Ÿå®ç°äº†äº”ç§æ§åˆ¶æ–¹æ³•çš„å…¨é¢å¯¹æ¯”ï¼š

| æ–¹æ³•    | æ¥æº     | å¹´ä»½ | ç±»å‹       |
| ------- | -------- | ---- | ---------- |
| PID     | ä¼ ç»Ÿæ§åˆ¶ | -    | åé¦ˆæ§åˆ¶   |
| DQN     | Nature   | 2015 | ç¦»æ•£RL     |
| SAC     | ICML     | 2018 | è¿ç»­RL     |
| TD-MPC2 | ICLR     | 2024 | æ¨¡å‹é¢„æµ‹RL |
| DPMD    | arXiv    | 2025 | æ‰©æ•£ç­–ç•¥RL |

### 8.2 å®éªŒç»“æœ

| æ–¹æ³•        | è¾¾æ ‡ç‡    | å¹³å‡å¥–åŠ± | æ”¶æ•›è½®æ¬¡ | æ¨ç†æ—¶é—´(ms) |
| ----------- | --------- | -------- | -------- | ------------ |
| PID         | 0.5%      | -42.3    | -        | 0.1          |
| DQN         | ~70%      | 5.2      | 150      | 0.8          |
| SAC         | 88.4%     | 8.7      | 100      | 1.2          |
| **TD-MPC2** | **89.7%** | **9.1**  | 80       | 2.5          |
| DPMD        | 86.4%     | 8.3      | 120      | 3.1          |

### 8.3 æ–¹æ³•å¯¹æ¯”åˆ†æ

**TD-MPC2ä¼˜åŠ¿**ï¼š

1. **æ ·æœ¬æ•ˆç‡é«˜**ï¼šä¸–ç•Œæ¨¡å‹æä¾›é¢å¤–ç›‘ç£ä¿¡å·
2. **è§„åˆ’èƒ½åŠ›å¼º**ï¼šCEMåœ¨çº¿è§„åˆ’è€ƒè™‘å¤šæ­¥æœªæ¥
3. **ç¨³å®šæ€§å¥½**ï¼šTDå­¦ä¹ æä¾›ç¨³å®šçš„å€¼ä¼°è®¡

**DPMDç‰¹ç‚¹**ï¼š

1. **è¡¨è¾¾èƒ½åŠ›å¼º**ï¼šæ‰©æ•£æ¨¡å‹å¯å­¦ä¹ å¤æ‚åˆ†å¸ƒ
2. **è®¡ç®—å¼€é”€å¤§**ï¼šéœ€è¦å¤šæ­¥å»å™ª

> **ğŸ“Š å›¾ç‰‡ä½ç½®ï¼š** åœ¨æ­¤å¤„æ’å…¥ `results/comparison/five_method_comparison.png` - äº”ç§æ–¹æ³•å¯¹æ¯”æŸ±çŠ¶å›¾

> **ğŸ“Š å›¾ç‰‡ä½ç½®ï¼š** åœ¨æ­¤å¤„æ’å…¥ `results/comparison/accuracy_comparison.png` - è¾¾æ ‡ç‡å¯¹æ¯”å›¾

---

## 9. å®‰å…¨çº¦æŸä¸å®¹é”™æœºåˆ¶

### 9.1 ç¡¬çº¦æŸæ£€æŸ¥

```python
def _apply_safety_constraints(self, decision, observation):
    """å®‰å…¨çº¦æŸæ£€æŸ¥ - ä¸å¯è¿å"""

    # Pmaxç¡¬çº¦æŸ
    if observation['Pmax'] > self.Pmax_limit:
        decision['vit'] = max(decision['vit'], -8.0)  # å¼ºåˆ¶æ»å
        decision['fuel'] = min(decision['fuel'], 0.8) # é™åˆ¶ç‡ƒæ²¹

    # VITèŒƒå›´çº¦æŸ
    decision['vit'] = np.clip(decision['vit'], self.vit_min, self.vit_max)

    # ç‡ƒæ²¹èŒƒå›´çº¦æŸ
    decision['fuel'] = np.clip(decision['fuel'], self.fuel_min, self.fuel_max)

    return decision
```

### 9.2 æ§åˆ¶æ¨¡å¼çŠ¶æ€æœº

```
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                            â”‚
           â–¼                            â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Pmaxè¶…é™    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   NORMAL    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  EMERGENCY  â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚                              â”‚
           â”‚ è¯Šæ–­æ•…éšœ                      â”‚ æ•…éšœæ¸…é™¤
           â–¼                              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ FAULT_TOLERANT  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  DEGRADED   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  ç¼¸æ³„æ¼    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.3 PIDå®‰å…¨å…œåº•

å½“TD-MPC2æœªå®Œæˆè®­ç»ƒæˆ–ç³»ç»Ÿå¤„äºå¼‚å¸¸çŠ¶æ€æ—¶ï¼ŒPIDæ§åˆ¶å™¨æ¥ç®¡ï¼š

$$
u(t) = K_p e(t) + K_i \int_0^t e(\tau) d\tau + K_d \frac{de(t)}{dt}
$$

å…¶ä¸­ï¼š

- $e(t) = P_{max}(t) - P_{target}$
- $K_p = 0.5$, $K_i = 0.05$, $K_d = 0.1$

---

## 10. ä»£ç å®ç°è¦ç‚¹

### 10.1 TDMPC2Controllerç±»

```python
class TDMPC2Controller:
    """
    TD-MPC2æ§åˆ¶å™¨ (ä¸»æ§åˆ¶ç®—æ³•)

    å®ç°:
    - ä¸–ç•Œæ¨¡å‹å­¦ä¹ çŠ¶æ€è½¬ç§»å’Œå¥–åŠ±é¢„æµ‹
    - CEMè§„åˆ’å™¨è¿›è¡Œåœ¨çº¿åŠ¨ä½œä¼˜åŒ–
    - é€‚é…æŸ´æ²¹æœºVIT/ç‡ƒæ²¹æ§åˆ¶æ¥å£

    æ€§èƒ½:
    - è¾¾æ ‡ç‡: 89.7% (äº”ç§æ–¹æ³•ä¸­æœ€é«˜)
    - æ¥æº: ICLR 2024
    """

    def __init__(self, state_dim=10, n_vit_actions=9, n_fuel_actions=5, device='cpu'):
        # åˆå§‹åŒ–TD-MPC2ç®—æ³•
        from .advanced_rl_algorithms import get_advanced_algorithm
        self.tdmpc2 = get_advanced_algorithm('TDMPC2', state_dim,
                                              n_vit_actions * n_fuel_actions,
                                              {'device': device})

        # åŠ¨ä½œæ˜ å°„
        self.vit_actions = np.linspace(-8, 4, n_vit_actions)
        self.fuel_actions = np.linspace(0.7, 1.0, n_fuel_actions)

    def select_action(self, state, training=True):
        """ä½¿ç”¨TD-MPC2 CEMè§„åˆ’é€‰æ‹©åŠ¨ä½œ"""
        return self.tdmpc2.select_action(state, explore=training)

    def decode_action(self, action_idx):
        """è§£ç åŠ¨ä½œç´¢å¼•ä¸ºVITå’Œç‡ƒæ²¹å€¼"""
        vit_idx = action_idx // self.n_fuel_actions
        fuel_idx = action_idx % self.n_fuel_actions
        return self.vit_actions[vit_idx], self.fuel_actions[fuel_idx]
```

### 10.2 HybridDiagnoserç±»

```python
class HybridDiagnoser:
    """
    æ··åˆæ•…éšœè¯Šæ–­å™¨
    KAN(60%) + PINN(40%) æŠ•ç¥¨èåˆ
    """

    def __init__(self, config=None):
        self.kan_weight = config.get('kan_weight', 0.6)
        self.pinn_weight = config.get('pinn_weight', 0.4)

        self.kan = KANDiagnoser(config.get('kan_config', {}))
        self.pinn = PINNDiagnoser(config.get('pinn_config', {}))

    def diagnose(self, features):
        """æ‰§è¡Œæ··åˆè¯Šæ–­"""
        kan_result = self.kan.diagnose(features)
        pinn_result = self.pinn.diagnose(features)

        if kan_result.fault_type == pinn_result.fault_type:
            # ä¸€è‡´ï¼šç›´æ¥è¾“å‡º
            confidence = max(kan_result.confidence, pinn_result.confidence)
        else:
            # ä¸ä¸€è‡´ï¼šåŠ æƒæŠ•ç¥¨
            scores = {}
            for fault_type in FaultType:
                scores[fault_type] = (
                    self.kan_weight * kan_result.get_prob(fault_type) +
                    self.pinn_weight * pinn_result.get_prob(fault_type)
                )
            best_fault = max(scores, key=scores.get)
            confidence = scores[best_fault]

        return HybridDiagnosisResult(
            fault_type=best_fault,
            confidence=confidence,
            symbolic_rules=kan_result.symbolic_rules,
            physics_residuals=pinn_result.physics_residuals
        )
```

---

## 11. æ€»ç»“ä¸å±•æœ›

### 11.1 ä¸»è¦è´¡çŒ®

1. **åŒæ™ºèƒ½ä½“ååŒæ¶æ„**ï¼šæå‡ºè¯Šæ–­-æ§åˆ¶åŒæ™ºèƒ½ä½“ååŒæ¡†æ¶ï¼Œé€šè¿‡æ¶ˆæ¯ä¼ é€’å®ç°å®æ—¶ä¿¡æ¯å…±äº«

2. **KAN+PINNæ··åˆè¯Šæ–­**ï¼šé¦–æ¬¡å°†KANå’ŒPINNç»“åˆç”¨äºæŸ´æ²¹æœºæ•…éšœè¯Šæ–­ï¼Œå…¼å…·å¯è§£é‡Šæ€§å’Œç‰©ç†ä¸€è‡´æ€§

3. **TD-MPC2æ§åˆ¶ç­–ç•¥**ï¼šå¼•å…¥æœ€æ–°çš„TD-MPC2ç®—æ³•ï¼Œè¾¾åˆ°89.7%çš„æ§åˆ¶è¾¾æ ‡ç‡

4. **å†²çªè§£å†³æœºåˆ¶**ï¼šè®¾è®¡å®‰å…¨ä¼˜å…ˆçš„å†²çªè§£å†³ç­–ç•¥ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œ

### 11.2 æ€§èƒ½æ€»ç»“

| æŒ‡æ ‡           | æœ¬ç³»ç»Ÿ | ä¼ ç»Ÿæ–¹æ³•  | æå‡ |
| -------------- | ------ | --------- | ---- |
| Pmaxæ§åˆ¶è¾¾æ ‡ç‡ | 89.7%  | 70% (DQN) | +28% |
| æ•…éšœæ£€æµ‹å‡†ç¡®ç‡ | 95%+   | 85%       | +12% |
| å“åº”æ—¶é—´       | 1.2s   | 2.8s      | -57% |
| å‡é˜³æ€§ç‡       | 2.1%   | 5.6%      | -63% |

### 11.3 æœªæ¥å·¥ä½œ

1. **åœ¨çº¿å­¦ä¹ å¢å¼º**ï¼šå®ç°æŒç»­åœ¨çº¿å­¦ä¹ ä»¥é€‚åº”å·¥å†µæ¼‚ç§»
2. **å¤šç¼¸ååŒæ§åˆ¶**ï¼šæ‰©å±•åˆ°å¤šç¼¸ç‹¬ç«‹æ§åˆ¶çš„åœºæ™¯
3. **é¢„æµ‹æ€§ç»´æŠ¤**ï¼šé›†æˆRULé¢„æµ‹å®ç°é¢„æµ‹æ€§ç»´æŠ¤
4. **å®èˆ¹éªŒè¯**ï¼šåœ¨å®é™…èˆ¹èˆ¶æŸ´æ²¹æœºä¸Šè¿›è¡ŒéªŒè¯

> **ğŸ“Š å›¾ç‰‡ä½ç½®ï¼š** åœ¨æ­¤å¤„æ’å…¥ `visualization_output/radar_comparison.png` - ç»¼åˆæ€§èƒ½é›·è¾¾å›¾

---

## é™„å½•Aï¼šå¯è§†åŒ–è¾“å‡ºå›¾ç‰‡åˆ—è¡¨

æœ¬ç³»ç»Ÿç”Ÿæˆçš„å¯è§†åŒ–å›¾ç‰‡åŠå…¶å¯¹åº”çš„CSVæ•°æ®æ–‡ä»¶ï¼š

### A.1 ä¸»è¦ç³»ç»Ÿå¯è§†åŒ–

| åºå· | å›¾ç‰‡æ–‡ä»¶                                          | å¯¹åº”CSVæ•°æ®æ–‡ä»¶                                                                                                                                                        | å»ºè®®æ’å…¥ä½ç½® | è¯´æ˜                                |
| ---- | ------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------ | ----------------------------------- |
| 1    | `visualization_output/training_process.png`       | `visualization_data/training_process.csv`, `five_method_learning_curves.csv`                                                                                           | 5.5èŠ‚        | TD-MPC2è®­ç»ƒè¿‡ç¨‹ï¼ˆä¸–ç•Œæ¨¡å‹æŸå¤±åˆ†è§£ï¼‰ |
| 2    | `visualization_output/simulation_results.png`     | `visualization_data/simulation_results.csv`, `five_method_vit_actions.csv`                                                                                             | 3.4èŠ‚        | äº”æ–¹æ³•ä»¿çœŸç»“æœå¯¹æ¯”                  |
| 3    | `visualization_output/performance_comparison.png` | `visualization_data/performance_metrics.csv`, `step_response.csv`, `performance_radar.csv`                                                                             | 6.4èŠ‚        | äº”æ–¹æ³•æ€§èƒ½å¯¹æ¯”                      |
| 4    | `visualization_output/diagnosis_analysis.png`     | `visualization_data/adaptive_threshold.csv`, `classifier_weights.csv`, `fault_type_accuracy.csv`, `detection_delay_stats.csv`, `confusion_matrix.csv`, `roc_curve.csv` | 4.4èŠ‚        | KAN+PINNæ··åˆè¯Šæ–­å™¨åˆ†æ              |
| 5    | `visualization_output/control_analysis.png`       | `visualization_data/tdmpc2_architecture.csv`, `horizon_prediction.csv`, `five_method_actions.csv`, `latent_space.csv`, `horizon_effect.csv`                            | 5.5èŠ‚        | TD-MPC2æ§åˆ¶æ™ºèƒ½ä½“åˆ†æ               |

### A.2 æ•°æ®é¢„å¤„ç†å¯è§†åŒ–ï¼ˆæ–°å¢ï¼‰

| åºå· | å›¾ç‰‡æ–‡ä»¶                                             | å¯¹åº”CSVæ•°æ®æ–‡ä»¶                                                                                                         | å»ºè®®æ’å…¥ä½ç½® | è¯´æ˜                     |
| ---- | ---------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------- | ------------ | ------------------------ |
| 6    | `visualization_output/steady_state_selection.png`    | `visualization_data/steady_state_timeseries.csv`, `steady_state_quality.csv`                                            | 2.3èŠ‚        | ç¨³æ€å·¥å†µæ™ºèƒ½ç­›é€‰æµç¨‹     |
| 7    | `visualization_output/representative_points.png`     | `visualization_data/operating_points_all.csv`, `representative_points.csv`                                              | 2.3èŠ‚        | ä»£è¡¨æ€§å·¥å†µç‚¹æå–ä¸éªŒè¯   |
| 8    | `visualization_output/data_cleaning.png`             | `visualization_data/data_cleaning_raw.csv`, `data_cleaning_final.csv`                                                   | 2.2èŠ‚        | æ•°æ®æ¸…æ´—ä¸å¼‚å¸¸å€¼å‰”é™¤æµç¨‹ |
| 9    | `visualization_output/normalization_correlation.png` | `visualization_data/data_raw.csv`, `data_minmax_normalized.csv`, `data_zscore_normalized.csv`, `correlation_matrix.csv` | 2.2èŠ‚        | æ•°æ®æ ‡å‡†åŒ–ä¸å‚æ•°å…³è”åˆ†æ |

**æ•°æ®é¢„å¤„ç†å¯è§†åŒ–è¯´æ˜ï¼š**

è¿™4ä¸ªæ–°å¢å¯è§†åŒ–å±•ç¤ºäº†æ ¡å‡†æ•°æ®çš„é¢„å¤„ç†æµç¨‹ï¼ŒåŒ…æ‹¬ï¼š

1. **ç¨³æ€å·¥å†µç­›é€‰** ([steady_state_selection.png](visualization_output/steady_state_selection.png))
   - åŸºäºRPMæ»šåŠ¨æ ‡å‡†å·®çš„ç¨³æ€æ®µè¯†åˆ«ç®—æ³•ï¼ˆçª—å£60sï¼Œé˜ˆå€¼1.0 rpmï¼‰
   - ç¨³æ€æ®µè´¨é‡è¯„ä¼°ï¼ˆç¨³å®šæ€§+æŒç»­æ—¶é—´ç»¼åˆè¯„åˆ†ï¼‰
   - ç¨³æ€/ç¬æ€å·¥å†µç‚¹åˆ†å¸ƒå¯¹æ¯”
   - æŒç»­æ—¶é—´åˆ†å¸ƒç»Ÿè®¡

2. **ä»£è¡¨æ€§å·¥å†µç‚¹æå–** ([representative_points.png](visualization_output/representative_points.png))
   - K-meansåˆ†å±‚æŠ½æ ·ç­–ç•¥ï¼ˆ10ä¸ªRPMåˆ†ç®±ï¼‰
   - å…¨å·¥å†µå›¾è°±è¦†ç›–åˆ†æ
   - ä»£è¡¨ç‚¹è´¨é‡è¯„ä¼°ï¼ˆæ ·æœ¬å¯†åº¦+ç¨³å®šæ€§è¯„åˆ†ï¼‰
   - Voronoiè¦†ç›–åŒºåŸŸå¯è§†åŒ–

3. **æ•°æ®æ¸…æ´—ä¸å¼‚å¸¸å€¼å‰”é™¤** ([data_cleaning.png](visualization_output/data_cleaning.png))
   - ç‰©ç†è¾¹ç•Œè¿‡æ»¤ï¼ˆRPM: 30-120, Pmax: 50-250 bar, Pcomp: 1-200 barï¼‰
   - Z-scoreå¼‚å¸¸æ£€æµ‹æ–¹æ³•
   - ç‰©ç†çº¦æŸä¸€è‡´æ€§æ£€æŸ¥ï¼ˆPmax > Pcompï¼‰
   - æ¸…æ´—å‰åæ•°æ®åˆ†å¸ƒå¯¹æ¯”

4. **æ•°æ®æ ‡å‡†åŒ–ä¸å‚æ•°å…³è”** ([normalization_correlation.png](visualization_output/normalization_correlation.png))
   - Min-Max vs Z-scoreæ ‡å‡†åŒ–å¯¹æ¯”
   - å‚æ•°ç›¸å…³æ€§çŸ©é˜µçƒ­åŠ›å›¾
   - Pcompç‰©ç†æ¨¡å‹ä¼°ç®—éªŒè¯ï¼ˆ$P_{comp} = p_{scav} \times \varepsilon^n$ï¼‰
   - PCAä¸»æˆåˆ†é™ç»´å¯è§†åŒ–

**ç”Ÿæˆè„šæœ¬ï¼š**

```bash
# ç”Ÿæˆæ•°æ®é¢„å¤„ç†å¯è§†åŒ–
python visualize_data_preprocessing.py
```

### CSVæ•°æ®ä½¿ç”¨è¯´æ˜

æ‰€æœ‰CSVæ–‡ä»¶ä¿å­˜åœ¨ `visualization_data/` ç›®å½•ï¼Œå¯ç›´æ¥å¯¼å…¥Originè¿›è¡Œå›¾è¡¨é‡ç»˜ï¼š

```bash
# ç”Ÿæˆ/æ›´æ–°ä¸»è¦ç³»ç»Ÿå¯è§†åŒ–CSVæ•°æ®
python export_visualization_data.py

# ç”Ÿæˆæ•°æ®é¢„å¤„ç†å¯è§†åŒ–CSVæ•°æ®
python visualize_data_preprocessing.py
```

**è®­ç»ƒè¿‡ç¨‹ç›¸å…³æ•°æ®ï¼š**

- `training_process.csv`: TD-MPC2è®­ç»ƒè¿‡ç¨‹ï¼ˆepisode, total_loss, dynamics_loss, reward_loss, value_loss, rewardç­‰ï¼‰
- `five_method_learning_curves.csv`: äº”æ–¹æ³•å­¦ä¹ æ›²çº¿å¯¹æ¯”

**ä»¿çœŸç»“æœç›¸å…³æ•°æ®ï¼š**

- `simulation_results.csv`: äº”æ–¹æ³•Pmaxå“åº”å¯¹æ¯”
- `five_method_vit_actions.csv`: äº”æ–¹æ³•VITæ§åˆ¶åŠ¨ä½œå¯¹æ¯”

**æ€§èƒ½å¯¹æ¯”ç›¸å…³æ•°æ®ï¼š**

- `performance_metrics.csv`: äº”ç§æ–¹æ³•çš„å…³é”®æŒ‡æ ‡å¯¹æ¯”
- `five_method_accuracy.csv`: è¾¾æ ‡ç‡å¯¹æ¯”
- `step_response.csv`: é˜¶è·ƒå“åº”å¯¹æ¯”
- `performance_radar.csv`: é›·è¾¾å›¾å½’ä¸€åŒ–æ•°æ®

**è¯Šæ–­åˆ†æç›¸å…³æ•°æ®ï¼š**

- `adaptive_threshold.csv`: KAN+PINNæ··åˆè‡ªé€‚åº”é˜ˆå€¼
- `classifier_weights.csv`: è¯Šæ–­å™¨æƒé‡åˆ†é…
- `fault_type_accuracy.csv`: æ•…éšœç±»å‹åˆ†ç±»å‡†ç¡®ç‡
- `detection_delay_stats.csv`: æ£€æµ‹å»¶è¿Ÿç»Ÿè®¡
- `confusion_matrix.csv`: 5Ã—5è¯Šæ–­æ··æ·†çŸ©é˜µ
- `roc_curve.csv`: å¤šæ–¹æ³•ROCæ›²çº¿

**æ§åˆ¶åˆ†æç›¸å…³æ•°æ®ï¼š**

- `tdmpc2_architecture.csv`: TD-MPC2ç½‘ç»œæ¶æ„
- `horizon_prediction.csv`: å¤šæ­¥horizoné¢„æµ‹è½¨è¿¹
- `five_method_actions.csv`: äº”æ–¹æ³•æ§åˆ¶åŠ¨ä½œå¯¹æ¯”
- `latent_space.csv`: æ½œåœ¨ç©ºé—´çŠ¶æ€åˆ†å¸ƒ
- `horizon_effect.csv`: è§„åˆ’horizonæ•ˆæœå¯¹æ¯”

**æ•°æ®é¢„å¤„ç†ç›¸å…³æ•°æ®ï¼ˆæ–°å¢ï¼‰ï¼š**

- `steady_state_timeseries.csv`: ç¨³æ€ç­›é€‰æ—¶é—´åºåˆ—æ•°æ®ï¼ˆtime, rpm, P_max, rpm_std, is_steadyï¼‰
- `steady_state_quality.csv`: ç¨³æ€æ®µè´¨é‡è¯„åˆ†ï¼ˆsegment_id, time_center, quality_scoreï¼‰
- `operating_points_all.csv`: å…¨éƒ¨å·¥å†µç‚¹æ•°æ®ï¼ˆrpm, P_max, P_comp, T_exhï¼‰
- `representative_points.csv`: ä»£è¡¨æ€§å·¥å†µç‚¹ï¼ˆpoint_id, rpm, P_max, P_comp, T_exhï¼‰
- `data_cleaning_raw.csv`: åŸå§‹æ•°æ®å«å¼‚å¸¸å€¼æ ‡è®°ï¼ˆrpm, P_max, P_comp, T_exh, is_outlierï¼‰
- `data_cleaning_final.csv`: æ¸…æ´—åæ•°æ®ï¼ˆrpm, P_max, P_comp, T_exhï¼‰
- `data_raw.csv`: åŸå§‹å‚æ•°å€¼ï¼ˆä¸åŒé‡çº²ï¼‰
- `data_minmax_normalized.csv`: Min-Maxæ ‡å‡†åŒ–å [0,1]
- `data_zscore_normalized.csv`: Z-scoreæ ‡å‡†åŒ–å (Î¼=0, Ïƒ=1)
- `correlation_matrix.csv`: å‚æ•°ç›¸å…³æ€§çŸ©é˜µ

**å®éªŒç»“æœï¼š**

- `results/five_method_summary.csv`: äº”æ–¹æ³•å¯¹æ¯”æ€»ç»“è¡¨

---

## é™„å½•Bï¼šç¬¦å·è¡¨

| ç¬¦å·          | å«ä¹‰                  | å•ä½  |
| ------------- | --------------------- | ----- |
| $P_{max}$     | æœ€é«˜çˆ†å‘å‹åŠ›          | bar   |
| $P_{comp}$    | å‹ç¼©ç»ˆç‚¹å‹åŠ›          | bar   |
| $T_{exh}$     | æ’æ°”æ¸©åº¦              | Â°C    |
| $r_i$         | ç¬¬$i$ä¸ªå‚æ•°çš„ç›¸å¯¹æ®‹å·® | -     |
| $\gamma$      | æŠ˜æ‰£å› å­              | -     |
| $\tau$        | è½¯æ›´æ–°ç³»æ•°            | -     |
| $\epsilon$    | æ¢ç´¢ç‡                | -     |
| $H$           | è§„åˆ’æ—¶åŸŸ              | steps |
| $Q(s,a)$      | çŠ¶æ€-åŠ¨ä½œå€¼å‡½æ•°       | -     |
| $\phi(x)$     | KANæ¿€æ´»å‡½æ•°           | -     |
| $\mathcal{L}$ | æŸå¤±å‡½æ•°              | -     |

---

## å‚è€ƒæ–‡çŒ®

1. Hansen, N., et al. "TD-MPC2: Scalable, Robust World Models for Continuous Control." _ICLR 2024_.

2. Liu, Z., et al. "KAN: Kolmogorov-Arnold Networks." _arXiv 2024_.

3. Raissi, M., et al. "Physics-informed neural networks: A deep learning framework for solving forward and inverse problems involving nonlinear partial differential equations." _Journal of Computational Physics, 2019_.

4. Mnih, V., et al. "Human-level control through deep reinforcement learning." _Nature, 2015_.

5. Haarnoja, T., et al. "Soft Actor-Critic: Off-Policy Maximum Entropy Deep Reinforcement Learning with a Stochastic Actor." _ICML 2018_.

6. Chi, C., et al. "Diffusion Policy: Visuomotor Policy Learning via Action Diffusion." _RSS 2023 / CoRL 2024_.
